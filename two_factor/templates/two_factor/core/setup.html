{% extends "two_factor/_base_focus.html" %}
{% load i18n %}

{% block extra_media %}
  {{ form.media }}
{% endblock %}

{% block head %}
{{ block.super }}
<style>
    .sign_up {
        max-width: 570px;
    }

    {% if wizard.steps.current == 'sms' %}
    .center_table label { margin: 0 10px; }
    .center_table th{ text-align: right; padding-right: 10px; width: 33%; }
    {% elif wizard.steps.current == 'generator' %}
    .center_table label { margin: 0 10px; }
    .center_table th { text-align: right; width: 33%; }
    .center_table input { width: unset !important;}
    {% elif wizard.steps.current == 'validation' %}
    .center_table th{ text-align: right; padding-right: 10px; width: 33%; }
    .center_table input { width: unset; }
    {% else %}
    .center_table label { margin: 0 10px; line-height: unset !important;}
    .center_table th { text-align: right;}
    .center_table input { width: unset !important;}
    {% endif %}
</style>
{% endblock %}

{% block title %}{% trans "Set up 2 step verification" %} {{wizard.steps.current}}{% endblock %}
{% block content %}
  {% if wizard.steps.current == 'welcome' %}
    <p>You are about to take your account security to the next level. Follow the steps in this wizard to enable 2 step verification</p>
  {% elif wizard.steps.current == 'method' %}
    <p>{% blocktrans trimmed %}Please select a verification method{% endblocktrans %}</p>
  {% elif wizard.steps.current == 'generator' %}
    <p>{% blocktrans trimmed %}To start using a token generator, please use your
        smartphone to scan the QR code below. For example, use Google
        Authenticator.{% endblocktrans %}</p>
    <p class="align_center"><img src="{{ QR_URL }}" alt="QR Code" class="bg-white"/></p>
    <p>Alternatively, paste the following one time password in your authenticator app.</p>
    <p><a href="{{ otpauth_url }}">{{ secret_key }}</a></p>
    <p> {% blocktrans %}Then, enter the token generated by the app.{% endblocktrans %}</p>

  {% elif wizard.steps.current == 'sms' %}
    <p>{% blocktrans trimmed %}Please enter the phone number you wish to receive the
      text messages on. This number will be validated in the next step.
      {% endblocktrans %}</p>
  {% elif wizard.steps.current == 'call' %}
    <p>{% blocktrans trimmed %}Please enter the phone number you wish to be called on.
      This number will be validated in the next step. {% endblocktrans %}</p>
  {% elif wizard.steps.current == 'validation' %}
    {% if challenge_succeeded %}
      {% if device.method == 'call' %}
        <p>{% blocktrans trimmed %}We are calling your phone right now, please enter the
          digits you hear.{% endblocktrans %}</p>
      {% elif device.method == 'sms' %}
          <p>{% blocktrans trimmed %}Please enter the verification code we sent to your phone ending <span class="orphan">in {{masked_number}}</span>{% endblocktrans %}</p>
      {% endif %}
    {% else %}
      <p class="alert alert-warning" role="alert">{% blocktrans trimmed %}We've
        encountered an issue with the selected authentication method. Please
        go back and verify that you entered your information correctly, try
        again, or use a different authentication method instead. If the issue
        persists, contact the site administrator.{% endblocktrans %}</p>
    {% endif %}
  {% elif wizard.steps.current == 'yubikey' %}
    <p>{% blocktrans trimmed %}To identify and verify your YubiKey, please insert a
      token in the field below. Your YubiKey will be linked to your
      account.{% endblocktrans %}</p>
  {% endif %}

  <form action="" method="post">{% csrf_token %}
    {% include "two_factor/_wizard_forms.html" %}

    {# hidden submit button to enable [enter] key #}
    <input type="submit" value="" hidden />

    {% include "two_factor/_wizard_actions.html" %}
  </form>
{% endblock %}
